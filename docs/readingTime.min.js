
(function(l, r) { if (l.getElementById('livereloadscript')) return; r = l.createElement('script'); r.async = 1; r.src = '//' + (window.location.host || 'localhost').split(':')[0] + ':35730/livereload.js?snipver=1'; r.id = 'livereloadscript'; l.getElementsByTagName('head')[0].appendChild(r) })(window.document);
var ReadingTime = (function (es_array_forEach_js, es_object_toString_js, es_promise_js, es_regexp_constructor_js, es_regexp_exec_js, es_regexp_toString_js, es_string_match_js, es_string_trim_js, web_domCollections_forEach_js, _regeneratorRuntime, runtime_js, _asyncToGenerator, _toConsumableArray, _classCallCheck, _defineProperty) {
  'use strict';

  function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

  var _regeneratorRuntime__default = /*#__PURE__*/_interopDefaultLegacy(_regeneratorRuntime);
  var _asyncToGenerator__default = /*#__PURE__*/_interopDefaultLegacy(_asyncToGenerator);
  var _toConsumableArray__default = /*#__PURE__*/_interopDefaultLegacy(_toConsumableArray);
  var _classCallCheck__default = /*#__PURE__*/_interopDefaultLegacy(_classCallCheck);
  var _defineProperty__default = /*#__PURE__*/_interopDefaultLegacy(_defineProperty);

  var ReadingTime = function ReadingTime(_ref) {
    var _this = this;

    var wordsTime = _ref.wordsTime,
        _elements = _ref.elements,
        regex = _ref.regex,
        imagesTime = _ref.imagesTime,
        _remote = _ref.remote,
        _ref$template = _ref.template,
        template = _ref$template === void 0 ? function () {} : _ref$template;

    _classCallCheck__default['default'](this, ReadingTime);

    _defineProperty__default['default'](this, "initial", function (elements) {
      _toConsumableArray__default['default'](elements).forEach(function (element, index) {
        var regLocal = element.dataset.rtRegex;
        var dataFile = element.dataset.file;
        var readWordsFromFile = dataFile ? _this.readFile(dataFile, _this.remote) : '';
        console.log(readWordsFromFile);
        var regexGlobal = regLocal !== undefined ? new RegExp("".concat(regLocal, "|s+"), 'g') : _this.regex;

        var numberImages = _this.getImages(element.innerHTML);

        var numberWords = _this.match(element.innerText.trim(), regexGlobal);

        var minuteWords = numberWords / _this.wordsTime;

        var imageTime = _this.imageReadTime(numberImages);

        var timeRead = _this.imagesTime ? minuteWords + imageTime : minuteWords;

        _this.template(index, timeRead, numberWords, numberImages, readWordsFromFile);
      });
    });

    _defineProperty__default['default'](this, "readFile", /*#__PURE__*/function () {
      var _ref2 = _asyncToGenerator__default['default']( /*#__PURE__*/_regeneratorRuntime__default['default'].mark(function _callee(file, remote) {
        var response, html, parser, doc, text;
        return _regeneratorRuntime__default['default'].wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _context.next = 2;
                return fetch(file);

              case 2:
                response = _context.sent;
                _context.next = 5;
                return response.text();

              case 5:
                html = _context.sent;
                parser = new DOMParser();
                doc = parser.parseFromString(html, 'text/html');
                text = doc.querySelector(remote.place);
                return _context.abrupt("return", text);

              case 10:
              case "end":
                return _context.stop();
            }
          }
        }, _callee);
      }));

      return function (_x, _x2) {
        return _ref2.apply(this, arguments);
      };
    }());

    _defineProperty__default['default'](this, "imageReadTime", function (images) {
      var second = images > 10 ? images / 2 * (_this.imagesTime + 3) + (images - 10) * 3 // n/2(a+b)+3sec/image
      : images / 2 * (2 * _this.imagesTime + (1 - images)); // n/2[2a+(n-1)d]

      return Math.ceil(second / 60);
    });

    _defineProperty__default['default'](this, "getImages", function (str) {
      var images = [];
      var img;

      while (img = _this.regexImg.exec(str)) {
        images.push(img[1]);
      }

      return images.length;
    });

    _defineProperty__default['default'](this, "match", function (str, regexLocal) {
      var matches = str.match(regexLocal);
      return matches ? matches.length + 1 : 0;
    });

    this.template = template;
    this.elements = document.querySelectorAll(_elements);
    this.regex = regex || /\s+/g;
    this.remote = _remote;
    this.regexImg = /<img([\w\W]+?)[/]?>/g;
    this.wordsTime = wordsTime || 200;
    this.imagesTime = imagesTime;
    [this.elements].forEach(function (element) {
      console.log(element);

      _this.initial(element);
    });
  };

  return ReadingTime;

}(null, null, null, null, null, null, null, null, null, _regeneratorRuntime, null, _asyncToGenerator, _toConsumableArray, _classCallCheck, _defineProperty));
//# sourceMappingURL=readingTime.min.js.map
